<!DOCTYPE html>
<!--
Template Name: Chevesic
Author: <a href="http://www.os-templates.com/">OS Templates</a>
Author URI: http://www.os-templates.com/
Licence: Free to use under our free template licence terms
Licence URI: http://www.os-templates.com/template-terms
-->
<html lang="">
<!-- To declare your language - read more here: https://www.w3.org/International/questions/qa-html-language-declarations -->
<head>
<title>LEAGUE MANAGER</title>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
<link href="layout/styles/layout.css" rel="stylesheet" type="text/css" media="all">
<script type="text/javascript">

	//page load시 대회 정보 및 클럽 정보 조회
	window.onload = function(){
		
		//대회 정보 조회가 아니고..이벤트 조회 필요할듯...?
		var xhttp = new XMLHttpRequest();
    var url = "http://52.79.188.98:3000/competition/get";
    xhttp.open("get", url, false);
    xhttp.setRequestHeader("Content-type", "application/json");
    xhttp.send();
	    
	    if (xhttp.readyState === 4) {
	        if (xhttp.status === 200) {
            var jsonResponse = JSON.parse(xhttp.responseText); 
	          //alert(xhttp.responseText);
	          //정상 여부 확인 필요 할듯

            var select = document.getElementById('competition');
            for (var i = 0; i< jsonResponse.length; i++){
                var opt = document.createElement('option');
                opt.value = jsonResponse[i].competition_id;
                opt.text = jsonResponse[i].title;
                // opt.innerHTML = i;
                select.appendChild(opt);
                
            }
            select.selectedIndex = 0;
            loadGame();
	        } else {
	          alert("저장에 실패 했습니다.");
	        }
	      }
	    
	    //클럽 정보 조회
      url = "http://52.79.188.98:3000/player/group";
      xhttp.open("get", url, false);
      xhttp.setRequestHeader("Content-type", "application/json");
      xhttp.send();

      if (xhttp.readyState === 4) {
          if (xhttp.status === 200) {
            var jsonResponse = JSON.parse(xhttp.responseText); 
            //alert(xhttp.responseText);
            //정상 여부 확인 필요 할듯

            var club = document.getElementById('Club');
            for (var i = 0; i< jsonResponse.length; i++){
                var opt = document.createElement('option');
                opt.value = jsonResponse[i].name;
                // opt.text = jsonResponse[i].group_id;
                // opt.innerHTML = i;
                club.appendChild(opt);
                
            }
          } else {
            alert("저장에 실패 했습니다.");
          }
        }
	    //select box에 추가 필요
	}

  function loadGame() {
    var xhttp = new XMLHttpRequest();
    var url = "http://52.79.188.98:3000/competition/event/get";
    var selectCompetion = document.getElementById('competition');
    url += "?competition_id=" + selectCompetion.options[selectCompetion.selectedIndex].value;
    xhttp.open("get", url, false);
    xhttp.setRequestHeader("Content-type", "application/json");
    xhttp.send();
    
    if (xhttp.readyState === 4) {
        if (xhttp.status === 200) {
          var jsonResponse = JSON.parse(xhttp.responseText); 
            //alert(xhttp.responseText);
            //정상 여부 확인 필요 할듯

            var select = document.getElementById('game');
            select.innerHTML = "";
            for (var i = 0; i<jsonResponse.length; i++){
                var opt = document.createElement('option');
                opt.value = jsonResponse[i].event_id;
                opt.text = jsonResponse[i].title;
                // opt.innerHTML = i;
                select.appendChild(opt);
            }
          //정상 여부 확인 필요 할듯
        } else {
          alert(xhttp.responseText);
        }
      }
    
  }
  

  function saveCompetition()
  {
    var xhttp = new XMLHttpRequest();
    var url = "http://52.79.188.98:3000/competition/add";
    url += "?title=" + competitonFrm.Title.value;
    url += "&start_date=" + competitonFrm.StartDate.value;
    url += "&end_date=" + competitonFrm.EndDate.value;
    url += "&phone=" + competitonFrm.Place.value;
    url += "&location=" + competitonFrm.Phone.value;
    url += "&account=" + competitonFrm.Account.value; 
    url += "&bank=" + competitonFrm.Bank.value;
    xhttp.open("get", url, false);
    xhttp.setRequestHeader("Content-type", "application/json");
    xhttp.send();
    
    if (xhttp.readyState === 4) {
        if (xhttp.status === 200) {
          var jsonResponse = JSON.parse(xhttp.responseText); 
          // alert(xhttp.responseText);
          window.open("makeGameType.html?leagueTitle="+jsonResponse[0].title+"&leagueID="+jsonResponse[0].competition_id);
          //정상 여부 확인 필요 할듯
        } else {
          alert(xhttp.responseText);
        }
      }
  
  }

	function savePlayer()
	{	
		alert("공사중!!");
	    //applyCompetition
	  
	}

</script>

 <style type="text/css">
.select-style {
    padding: 0;
    margin: 2px;
    margin-bottom:15px;
    border: 1px solid #9D8D65;
    width: 120px;
    border-radius: 3px;
    overflow: hidden;
    background-color: black;

    background: black no-repeat 90% 50%;
}

.select-style select {
    padding: 1px 4px;
    width: 130%;
    border: none;
    box-shadow: none;
    background-color: black;
    background-image: none;
    color: #FFFFFF;
    -webkit-appearance: none;
       -moz-appearance: none;
            appearance: none;
}

.select-style select:focus {
    outline: none;
  border-color:#9D8D65;
}
  </style>

</head>
<body id="top">
<!-- ################################################################################################ -->
<!-- ################################################################################################ -->
<!-- ################################################################################################ -->
<!-- Top Background Image Wrapper -->

    <header id="header" class="hoc clear"> 
      <!-- ################################################################################################ -->
      <div id="logo" class="fl_left">
        <h1><a href="index.html">TABLE TENNIS</a></h1>
        <p>LEAGUE MANAGER</p>
      </div>
      <div id="quickinfo" class="fl_right">
        <ul class="nospace inline">
          <li><strong>Phone:</strong><br>
            +82 (010) 1234 5678</li>
          <li><strong>E-mail:</strong><br>
            indal@kaist.ac.kr</li>
        </ul>
      </div>
      <!-- ################################################################################################ -->
    </header>
    <nav id="mainav" class="hoc clear"> 
      <!-- ################################################################################################ -->
      <ul class="clear">
        <li><a href="index.html">Home</a></li>
        <li><a href="makeleague.html">MAKE LEAGUE</a></li>
        <li><a href="makeGameType.html">MAKE GAME</a></li>
        <li class="active"><a href="#">JOIN LEAGUE</a></li>
        <li><a href="leagueView.html">GAME TABLE</a></li>
      </ul>
      <!-- ################################################################################################ -->
    </nav>

<div class="bgded" style="background-image:url('images/demo/backgrounds/01.png');"> 
  <!-- ################################################################################################ -->
  <!-- ################################################################################################ -->
  <!-- ################################################################################################ -->
  <div class="wrapper row1">
  <footer id="footer" class="hoc clear"> 
    <!-- ################################################################################################ -->  
       <form name="playerFrm" method="get" onSubmit="JavaScript:savePlayer()">
        <fieldset>
			<legend>Newsletter:</legend>
      <div class="select-style" style="float: left; width: 33%;"">
      <select class="btmspace-15" id="competition" onchange="loadGame()"></select>
      </div>
      <div class="select-style" style="float: left; width: 33%;">
      <select class="btmspace-15" id="game"></select>
      </div>
			<input list="Club" class="btmspace-15" type="text" value="" placeholder="Name of Club">
      <datalist id="Club">
        
      </datalist> 
			<input id="Name" class="btmspace-15" type="text" value="" placeholder="Your Name">
			<input id="Phone" class="btmspace-15" type="text" value="" placeholder="Phone">
			<input id="Grade" class="btmspace-15" type="text" value="" placeholder="Grade">
			<input type="submit" value="참가 신청"  style="cursor:pointer"></input>
          </fieldset>
      </form>
    
    <!-- ################################################################################################ -->
  </footer>
</div></div>
 
<!-- ################################################################################################ -->
<!-- ################################################################################################ -->
<!-- ################################################################################################ -->
<a id="backtotop" href="#top"><i class="fa fa-chevron-up"></i></a>
<!-- JAVASCRIPTS -->
<script src="layout/scripts/jquery.min.js"></script>
<script src="layout/scripts/jquery.backtotop.js"></script>
<script src="layout/scripts/jquery.mobilemenu.js"></script>
</body>
</html>